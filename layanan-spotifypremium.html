<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YorPedia - Spotify Premium</title>
<style>
  body { font-family: 'Poppins', sans-serif; background-color: #f5f5f5; margin:0; padding:0; }
  header { display:flex; align-items:center; background:#fff; padding:10px 15px; box-shadow:0 1px 4px rgba(0,0,0,0.1);}
  .btn-back { display:inline-flex; align-items:center; justify-content:center; width:38px; height:38px; background:#f0f0f0; border-radius:8px; text-decoration:none; margin-right:10px; transition:0.2s;}
  .btn-back:hover{background:#e0e0e0;}
  header h1{font-size:1.2em;margin:0;color:#222;}
  .container{max-width:600px;margin:30px auto;background:#fff;padding:25px;border-radius:15px;box-shadow:0 2px 8px rgba(0,0,0,0.05);}
  label{display:block;margin-top:15px;font-weight:600;color:#444;}
  input,select,textarea{width:100%;padding:12px;margin-top:8px;border:1px solid #ccc;border-radius:10px;font-family:'Poppins',sans-serif;font-size:14px;box-sizing:border-box;}
  textarea{resize:none;min-height:80px;}
  button{width:100%;background:#e53935;color:#fff;border:none;padding:12px;border-radius:10px;font-size:1em;font-weight:600;margin-top:25px;cursor:pointer;transition:0.2s;}
  button:hover{background:#d32f2f;}
  button:disabled{background:#ccc; cursor:not-allowed;}
  .total-box{margin-top:20px;padding:15px;background:#f9f9f9;border-radius:10px;font-weight:600;text-align:center;color:#333;border:1px solid #ddd;}
  .promo-invalid{font-size:0.9em;margin-top:5px;}
  .popup{position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;align-items:center;justify-content:center;z-index:999;}
  .popup-content{background:#fff;padding:20px;border-radius:15px;width:90%;max-width:400px;position:relative;text-align:center;box-shadow:0 2px 10px rgba(0,0,0,0.2);}
  .close{position:absolute;right:15px;top:10px;cursor:pointer;font-weight:bold;font-size:20px;}
  .pay-method{text-align:left;margin-top:15px;}
  .confirm-btn{background:#4caf50;color:#fff;border:none;padding:10px;border-radius:10px;width:100%;font-weight:600;margin-top:15px;}
</style>
</head>

<body>
<header>
  <a href="index.html" class="btn-back">←</a>
  <h1>Spotify Premium</h1>
</header>

<div class="container">
<form id="formWA">

<label>Nama Lengkap</label>
<input type="text" id="nama" required>

<label>Nomor WhatsApp</label>
<input type="tel" id="wa" required>

<label>Email</label>
<input type="email" id="email" required>

<label>Durasi</label>
<select id="durasi">
  <option value="7900">Rp7.900 / 1bln</option>
  <option value="12900" selected>Rp12.900 / 1bln</option>
  <option value="17900">Rp17.900 / 1bln</option>
  <option value="32000">Rp32.000 / 2bln</option>
</select>

<label>Jumlah</label>
<input type="number" id="jumlah" value="1" min="1">

<label>Kode Promo</label>
<input type="text" id="promo">
<div id="promoMsg" class="promo-invalid"></div>

<div class="total-box">
  Total: <span id="totalHarga">Rp0</span>
</div>

<label>Catatan</label>
<textarea id="catatan"></textarea>

<button type="button" id="btnBayar" disabled>Metode Pembayaran</button>
</form>
</div>

<div class="popup" id="popup">
<div class="popup-content">
<span class="close" onclick="tutupPopup()">✖</span>
<h3>Pilih Pembayaran</h3>

<div class="pay-method">
QRIS / DANA / GOPAY<br>0831-7715-2459
</div>

<p><b>Total:</b> <span id="totalBayar">Rp0</span></p>

<button class="confirm-btn" onclick="kirimWA()">Konfirmasi</button>
</div>
</div>

<script>
const promoInput = document.getElementById('promo');
const promoMsg = document.getElementById('promoMsg');
const totalHarga = document.getElementById('totalHarga');
const totalBayar = document.getElementById('totalBayar');
const btnBayar = document.getElementById('btnBayar');
const popup = document.getElementById('popup');
const form = document.getElementById('formWA');

let promoList = [];
let diskon = 0;

fetch('promo.json')
.then(res => res.json())
.then(data => promoList = data.promo)
.catch(()=>{});

function cekPromo(){
  const kode = promoInput.value.trim().toUpperCase();
  const p = promoList.find(x => x.code === kode);
  if(p){
    diskon = p.discount;
    promoMsg.textContent = `Diskon ${diskon*100}%`;
    promoMsg.style.color = "green";
  } else {
    diskon = 0;
    promoMsg.textContent = kode ? "Promo tidak valid" : "";
    promoMsg.style.color = "red";
  }
}

function hitungTotal(){
  cekPromo();
  const harga = parseInt(durasi.value);
  const jumlah = parseInt(document.getElementById('jumlah').value) || 1;
  const total = harga * jumlah * (1 - diskon);
  totalHarga.textContent = "Rp" + total.toLocaleString("id-ID");
  totalBayar.textContent = totalHarga.textContent;
}

function checkForm(){
  const nama = document.getElementById('nama').value.trim();
  const wa = document.getElementById('wa').value.trim();
  const email = document.getElementById('email').value.trim();
  const jumlah = document.getElementById('jumlah').value;
  btnBayar.disabled = !(nama && wa && email && jumlah > 0);
  hitungTotal();
}

form.addEventListener('input', checkForm);
promoInput.addEventListener('input', hitungTotal);

btnBayar.onclick = () => popup.style.display = 'flex';
function tutupPopup(){ popup.style.display = 'none'; }

function kirimWA(){
  const nama = document.getElementById('nama').value;
  const wa = document.getElementById('wa').value;
  const email = document.getElementById('email').value;
  const durasiText = durasi.options[durasi.selectedIndex].text;
  const jumlah = document.getElementById('jumlah').value;
  const total = totalHarga.textContent;
  const promo = promoInput.value || "-";
  const catatan = document.getElementById('catatan').value || "-";

  const pesan =
`*Spotify Premium*
Nama: ${nama}
WA: ${wa}
Email: ${email}
Durasi: ${durasiText}
Jumlah: ${jumlah}
Total: ${total}
Promo: ${promo}
Catatan: ${catatan}`;

  window.open(`https://wa.me/6283177152459?text=${encodeURIComponent(pesan)}`);
}

hitungTotal();
checkForm();
</script>
</body>
</html>
