<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YorPedia - ChatGPT Plus</title>
<style>
  body { font-family:'Poppins',sans-serif;background:#f5f5f5;margin:0 }
  header{display:flex;align-items:center;background:#fff;padding:10px 15px}
  .btn-back{width:38px;height:38px;background:#f0f0f0;border-radius:8px;display:flex;align-items:center;justify-content:center;text-decoration:none;margin-right:10px}
  .container{max-width:600px;margin:30px auto;background:#fff;padding:25px;border-radius:15px}
  label{display:block;margin-top:15px;font-weight:600}
  input,select,textarea{width:100%;padding:12px;margin-top:8px;border:1px solid #ccc;border-radius:10px}
  textarea{min-height:80px;resize:none}
  button{width:100%;background:#e53935;color:#fff;border:none;padding:12px;border-radius:10px;margin-top:25px;font-weight:600}
  button:disabled{background:#ccc}
  .total-box{margin-top:20px;padding:15px;background:#f9f9f9;border-radius:10px;text-align:center;font-weight:600}
  .promo-invalid{font-size:.9em;margin-top:5px}
  .popup{position:fixed;inset:0;background:rgba(0,0,0,.5);display:none;align-items:center;justify-content:center}
  .popup-content{background:#fff;padding:20px;border-radius:15px;width:90%;max-width:400px;text-align:center}
  .close{position:absolute;right:15px;top:10px;cursor:pointer}
  .confirm-btn{background:#4caf50;color:#fff;border:none;padding:10px;border-radius:10px;width:100%;margin-top:15px}
</style>
</head>

<body>
<header>
  <a href="index.html" class="btn-back">←</a>
  <h1>ChatGPT Plus</h1>
</header>

<div class="container">
<form id="formWA">
  <label>Nama Lengkap</label>
  <input type="text" id="nama" required>

  <label>Nomor WhatsApp</label>
  <input type="tel" id="wa" required>

  <label>Email</label>
  <input type="email" id="email" required>

  <label>Durasi</label>
  <select id="durasi" required>
    <option value="" disabled selected>Pilih Durasi</option>
    <option value="9000">Rp9.000 / 7hr</option>
    <option value="14000">Rp14.000 / 7hr ⚡</option>
    <option value="19000">Rp19.000 / 1bln</option>
    <option value="29000">Rp29.000 / 1bln ⚡</option>
  </select>

  <label>Jumlah</label>
  <input type="number" id="jumlah" value="1" min="1" required>

  <label>Kode Promo</label>
  <input type="text" id="promo">
  <div id="promoMsg" class="promo-invalid"></div>

  <div class="total-box">Total: <span id="totalHarga">Rp0</span></div>

  <label>Catatan</label>
  <textarea id="catatan"></textarea>

  <button type="button" id="btnBayar" disabled>Metode Pembayaran</button>
</form>
</div>

<div class="popup" id="popup">
  <div class="popup-content">
    <span class="close" onclick="tutupPopup()">✖</span>
    <p>Total Bayar: <b id="totalBayar">Rp0</b></p>
    <button class="confirm-btn" onclick="kirimWA()">Konfirmasi Pembayaran</button>
  </div>
</div>

<script>
const promoInput = document.getElementById('promo');
const promoMsg = document.getElementById('promoMsg');
const btnBayar = document.getElementById('btnBayar');
const popup = document.getElementById('popup');
const totalHarga = document.getElementById('totalHarga');
const totalBayar = document.getElementById('totalBayar');
const form = document.getElementById('formWA');

let diskon = 0;
let promoList = [];

fetch('promo.json')
  .then(r => r.json())
  .then(d => promoList = d.promo)
  .catch(()=>{});

function cekPromo(){
  const kode = promoInput.value.trim().toUpperCase();
  const promo = promoList.find(p => p.code === kode);

  if(promo){
    diskon = promo.discount;
    promoMsg.textContent = `Diskon ${diskon*100}% aktif`;
    promoMsg.style.color = "green";
  }else if(kode){
    diskon = 0;
    promoMsg.textContent = "Kode promo tidak valid";
    promoMsg.style.color = "red";
  }else{
    diskon = 0;
    promoMsg.textContent = "";
  }
}

function hitungTotal(){
  cekPromo();
  const harga = parseInt(durasi.value) || 0;
  const jumlahVal = parseInt(jumlah.value) || 1;
  const total = harga * jumlahVal * (1 - diskon);
  totalHarga.textContent = "Rp" + total.toLocaleString("id-ID");
  totalBayar.textContent = totalHarga.textContent;
}

function checkForm(){
  btnBayar.disabled = !(nama.value && wa.value && email.value && durasi.value && jumlah.value);
  hitungTotal();
}

form.addEventListener('input', checkForm);
promoInput.addEventListener('input', hitungTotal);

btnBayar.onclick = () => popup.style.display = 'flex';
function tutupPopup(){ popup.style.display = 'none'; }

function kirimWA(){
  const pesan =
`*ChatGPT Plus*
Nama: ${nama.value}
WhatsApp: ${wa.value}
Email: ${email.value}
Durasi: ${durasi.options[durasi.selectedIndex].text}
Jumlah: ${jumlah.value}
Total: ${totalHarga.textContent}
Kode Promo: ${promoInput.value || "-"}
Catatan: ${catatan.value || "-"}`;

  window.open(
    `https://wa.me/6283177152459?text=${encodeURIComponent(pesan)}`,
    "_blank"
  );
}

checkForm();
</script>
</body>
</html>
